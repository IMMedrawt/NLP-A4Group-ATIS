# SQL Generation and Classification

This project implements multiple approaches for translating English questions into SQL queries. It includes classification-based and generation-based methods, evaluated on two datasets: `geography.json` and `atis.json`. Evaluation is done under two settings: `question_split` and `query_split`.

## Project Structure

```
.
├── data/                 # Raw datasets (geography.json, atis.json)
├── processed_data/       # Preprocessed train/dev/test splits
├── outputs/              # Output predictions and accuracy results
├── script/               # All code files: preprocessing, models, training scripts
├── README.md             # Project documentation
```

## Dataset Files

- `geography.json`: Geography questions and SQLs
- `atis.json`: ATIS dataset for flight-related queries
- `atis-fields.txt`, `atis-schema.csv`: Additional schema info for ATIS (optional)

## Preprocessed Data

Generated by:

- `dataset_geography.py`
- `dataset_atis.py`

Outputs are JSON files:

- `train_question_split.json`
- `dev_question_split.json`
- `test_question_split.json`
- (similar for `query_split`)

## Code Overview

### Dataset Processing

- `dataset_geography.py`: Converts `geography.json` into train/dev/test
- `dataset_atis.py`: Converts `atis.json` into train/dev/test

Run with:

```
python dataset_geography.py
python dataset_atis.py
```

### Models

All models are in `models.py`:

- `LinearClassifier`
- `FeedforwardClassifier`
- `LSTMClassifier`
- `TransformerTextClassifier`

### Training Scripts

Each classifier has its own script:

- `train_linear.py`
- `train_feedforward.py`
- `train_lstm.py`
- `train_transformer.py`

Run with:

```
python train_{model}.py --dataset {geography|atis} --split {question_split|query_split}
```

Example:

```
python train_linear.py --dataset geography --split question_split
```

Outputs go to:

```
outputs/{dataset}_{model}_{split}/results.txt
```

## Output Format

Each `results.txt` contains:

- Accuracy score
- Question, predicted SQL, and ground truth SQL

Example:

```
Accuracy (valid only): 0.5094
Q: What is the population of California?
PRED: SELECT STATEalias0.POPULATION FROM ...
GOLD: SELECT STATEalias0.POPULATION FROM ...
```
